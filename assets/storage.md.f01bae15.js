import{_ as s,o as a,c as l,Q as n}from"./chunks/framework.9b0cfcaf.js";const h=JSON.parse('{"title":"Хранилище","description":"","frontmatter":{},"headers":[],"relativePath":"storage.md","filePath":"storage.md"}'),p={name:"storage.md"},o=n(`<h1 id="хранилище" tabindex="-1">Хранилище <a class="header-anchor" href="#хранилище" aria-label="Permalink to &quot;Хранилище&quot;">​</a></h1><p>Шлюз использует хранилище для хранения конфигов, скриптов, звуков и прочих файлов. Может использовать как внутренняя флеш-память так и внешняя на SD-картах. Записывать также можно через сценарии, <a href="https://github.com/slsys/Gateway/blob/master/samples.md#%D1%81%D0%BE%D1%85%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B7%D0%BD%D0%B0%D1%87%D0%B5%D0%BD%D0%B8%D0%B9-%D0%B2-json-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-lua" target="_blank" rel="noreferrer">пример</a>.</p><h2 id="структура" tabindex="-1">Структура <a class="header-anchor" href="#структура" aria-label="Permalink to &quot;Структура&quot;">​</a></h2><p>Хранилище использует префиксы для обозначения источника данных.</p><ul><li>/int - для внутренней файловой системы, его использование не обязательно</li><li>/sd - для <a href="https://github.com/slsys/Gateway/blob/master/lua_doc/sd.md" target="_blank" rel="noreferrer">SD-карты</a></li></ul><h2 id="фаиловые-системы" tabindex="-1">Файловые системы <a class="header-anchor" href="#фаиловые-системы" aria-label="Permalink to &quot;Файловые системы&quot;">​</a></h2><p>Поддерживается несколько файловых систем для хранилища:</p><ul><li>FAT - классическая файловая система</li><li>LFS - надежная файловая система для микроконтроллеров LittleFS, не повреждается при неожиданных отключениях питания (доступна с версии 2022.03.29d4)</li></ul><p>Для выбора файловой системы используется разметка указанная в файле разделов при прошивке устройства.</p><p>Для перехода на другую файловую систему необходимо сделать бэкап всех файлов и перепрошить устройство с нужным файлом разделов. При этом хранилище будет отформатировано.</p><h2 id="http-api" tabindex="-1">HTTP API <a class="header-anchor" href="#http-api" aria-label="Permalink to &quot;HTTP API&quot;">​</a></h2><p>Большая часть команд возвращает объект JSON:</p><p>При успехе:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span><span style="color:#79B8FF;">&quot;success&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">&quot;result&quot;</span><span style="color:#E1E4E8;">:[]</span><span style="color:#FDAEB7;font-style:italic;">|</span><span style="color:#E1E4E8;">{}}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span><span style="color:#005CC5;">&quot;success&quot;</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">&quot;result&quot;</span><span style="color:#24292E;">:[]</span><span style="color:#B31D28;font-style:italic;">|</span><span style="color:#24292E;">{}}</span></span></code></pre></div><p>При ошибке</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{ </span><span style="color:#79B8FF;">&quot;success&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{ </span><span style="color:#005CC5;">&quot;success&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> }</span></span></code></pre></div><p>Пути могут обозначаться:</p><ul><li>/ или /int - внутренняя файловая система</li><li>/sd - SD-карта</li></ul><h3 id="получить-список-фаилов" tabindex="-1">Получить список файлов <a class="header-anchor" href="#получить-список-фаилов" aria-label="Permalink to &quot;Получить список файлов&quot;">​</a></h3><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GET</span><span style="color:#E1E4E8;"> /api/storage?path=/</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GET</span><span style="color:#24292E;"> /api/storage?path=/</span></span></code></pre></div><p>JSON result:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span></span>
<span class="line"><span style="color:#E1E4E8;">  { </span><span style="color:#79B8FF;">&quot;name&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;test.txt&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">&quot;is_dir&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">&quot;size&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">8</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">  { </span><span style="color:#79B8FF;">&quot;name&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;testDir&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">&quot;is_dir&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span></span>
<span class="line"><span style="color:#24292E;">  { </span><span style="color:#005CC5;">&quot;name&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;test.txt&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">&quot;is_dir&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">&quot;size&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">8</span><span style="color:#24292E;"> },</span></span>
<span class="line"><span style="color:#24292E;">  { </span><span style="color:#005CC5;">&quot;name&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;testDir&quot;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">&quot;is_dir&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> }</span></span>
<span class="line"><span style="color:#24292E;">]</span></span></code></pre></div><ul><li><code>name</code> - имя файла или каталога</li><li><code>is_dir</code> - true - каталог, false - файл</li><li><code>size</code> - размер файла в байтах</li></ul><h3 id="чтение-содержимого-фаила" tabindex="-1">Чтение содержимого файла <a class="header-anchor" href="#чтение-содержимого-фаила" aria-label="Permalink to &quot;Чтение содержимого файла&quot;">​</a></h3><p>Возвращает содержимое файла</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GET</span><span style="color:#E1E4E8;"> /api/storage?path=/sd/test.txt</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GET</span><span style="color:#24292E;"> /api/storage?path=/sd/test.txt</span></span></code></pre></div><h3 id="запись-в-фаил" tabindex="-1">Запись в файл <a class="header-anchor" href="#запись-в-фаил" aria-label="Permalink to &quot;Запись в файл&quot;">​</a></h3><p>Запись в файл. Если файла не существует - он будет создан. Файл будет перезаписан!</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">POST</span><span style="color:#E1E4E8;"> /api/storage?path=/test.lua&amp;plain=XXX</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">POST</span><span style="color:#24292E;"> /api/storage?path=/test.lua&amp;plain=XXX</span></span></code></pre></div><p>Возвращает</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span><span style="color:#79B8FF;">&quot;success&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">true</span><span style="color:#FDAEB7;font-style:italic;">|</span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span><span style="color:#005CC5;">&quot;success&quot;</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">true</span><span style="color:#B31D28;font-style:italic;">|</span><span style="color:#005CC5;">false</span><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="удаление-фаила" tabindex="-1">Удаление файла <a class="header-anchor" href="#удаление-фаила" aria-label="Permalink to &quot;Удаление файла&quot;">​</a></h3><p>Удаляет файл</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">DELETE</span><span style="color:#E1E4E8;"> /api/storage?path=/test.txt</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">DELETE</span><span style="color:#24292E;"> /api/storage?path=/test.txt</span></span></code></pre></div><p>Возвращает</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span><span style="color:#79B8FF;">&quot;success&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">true</span><span style="color:#FDAEB7;font-style:italic;">|</span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span><span style="color:#005CC5;">&quot;success&quot;</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">true</span><span style="color:#B31D28;font-style:italic;">|</span><span style="color:#005CC5;">false</span><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="монтирование-sd-накопителя" tabindex="-1">Монтирование SD накопителя <a class="header-anchor" href="#монтирование-sd-накопителя" aria-label="Permalink to &quot;Монтирование SD накопителя&quot;">​</a></h3><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GET</span><span style="color:#E1E4E8;"> /api/storage/sd?action=mount</span></span>
<span class="line"><span style="color:#F97583;">GET</span><span style="color:#E1E4E8;"> /api/storage/sd?action=umount</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GET</span><span style="color:#24292E;"> /api/storage/sd?action=mount</span></span>
<span class="line"><span style="color:#D73A49;">GET</span><span style="color:#24292E;"> /api/storage/sd?action=umount</span></span></code></pre></div><p>Возвращает</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{ </span><span style="color:#79B8FF;">&quot;success&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">&quot;result&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;mount|umount&quot;</span><span style="color:#E1E4E8;"> }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{ </span><span style="color:#005CC5;">&quot;success&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">&quot;result&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;mount|umount&quot;</span><span style="color:#24292E;"> }</span></span></code></pre></div><h3 id="информация-о-хранилище" tabindex="-1">Информация о хранилище <a class="header-anchor" href="#информация-о-хранилище" aria-label="Permalink to &quot;Информация о хранилище&quot;">​</a></h3><p>Возвращает информацию о внутреннем хранилище и SD-карте</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GET</span><span style="color:#E1E4E8;"> /api/storage/info</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GET</span><span style="color:#24292E;"> /api/storage/info</span></span></code></pre></div><p>JSON result:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">&quot;int&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;fs&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;LFS&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;total&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">4194304</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;free&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">4030464</span></span>
<span class="line"><span style="color:#E1E4E8;">  },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">&quot;sd&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;size&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">30953963520</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;total&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">30918311936</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;free&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">30918262784</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;status&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;SDHC&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;int&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;fs&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;LFS&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;total&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">4194304</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;free&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">4030464</span></span>
<span class="line"><span style="color:#24292E;">  },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;sd&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;size&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">30953963520</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;total&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">30918311936</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;free&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">30918262784</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;status&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;SDHC&quot;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><ul><li>int - внутренний накопитель <ul><li>fs - файловая система</li><li>total - размер флэш в байтах</li><li>free - свободно байт</li></ul></li><li>sd - SD-карта <ul><li>status - тип карты</li><li>size - размер карты в байтах</li><li>total - размер раздела в байтах</li><li>free - свободно байт</li></ul></li></ul><h3 id="переименование-фаилов" tabindex="-1">Переименование файлов <a class="header-anchor" href="#переименование-фаилов" aria-label="Permalink to &quot;Переименование файлов&quot;">​</a></h3><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GET</span><span style="color:#E1E4E8;"> /api/storage/rename?old=/file1.lua&amp;new=/file2.lua</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GET</span><span style="color:#24292E;"> /api/storage/rename?old=/file1.lua&amp;new=/file2.lua</span></span></code></pre></div><p>Возвращает</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span><span style="color:#79B8FF;">&quot;success&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">true</span><span style="color:#FDAEB7;font-style:italic;">|</span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span><span style="color:#005CC5;">&quot;success&quot;</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">true</span><span style="color:#B31D28;font-style:italic;">|</span><span style="color:#005CC5;">false</span><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="создать-директорию" tabindex="-1">Создать директорию <a class="header-anchor" href="#создать-директорию" aria-label="Permalink to &quot;Создать директорию&quot;">​</a></h3><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GET</span><span style="color:#E1E4E8;"> /api/storage/mkdir?path=/int/mydir</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GET</span><span style="color:#24292E;"> /api/storage/mkdir?path=/int/mydir</span></span></code></pre></div><p>Возвращает</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span><span style="color:#79B8FF;">&quot;success&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">true</span><span style="color:#FDAEB7;font-style:italic;">|</span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span><span style="color:#005CC5;">&quot;success&quot;</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">true</span><span style="color:#B31D28;font-style:italic;">|</span><span style="color:#005CC5;">false</span><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="удалить-директорию" tabindex="-1">Удалить директорию <a class="header-anchor" href="#удалить-директорию" aria-label="Permalink to &quot;Удалить директорию&quot;">​</a></h3><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GET</span><span style="color:#E1E4E8;"> /api/storage/rmdir?path=/int/mydir</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GET</span><span style="color:#24292E;"> /api/storage/rmdir?path=/int/mydir</span></span></code></pre></div><p>Возвращает</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span><span style="color:#79B8FF;">&quot;success&quot;</span><span style="color:#E1E4E8;">:</span><span style="color:#79B8FF;">true</span><span style="color:#FDAEB7;font-style:italic;">|</span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span><span style="color:#005CC5;">&quot;success&quot;</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">true</span><span style="color:#B31D28;font-style:italic;">|</span><span style="color:#005CC5;">false</span><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="скрипты-lua" tabindex="-1">Скрипты <a href="/Gateway/lua">LUA</a> <a class="header-anchor" href="#скрипты-lua" aria-label="Permalink to &quot;Скрипты [LUA](/lua.md)&quot;">​</a></h2><p>Во всех операциях с файлами под именем подразумевается путь:</p><ul><li>для int - <code>/file</code> или <code>/int/file</code></li><li>для SD - <code>/sd/file</code></li></ul><h3 id="os-mountsd" tabindex="-1">os.mountSD() <a class="header-anchor" href="#os-mountsd" aria-label="Permalink to &quot;os.mountSD()&quot;">​</a></h3><p>Монтирует SD-карту</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">result </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> os.</span><span style="color:#79B8FF;">mountSD</span><span style="color:#E1E4E8;">(mount)</span></span>
<span class="line"><span style="color:#6A737D;">-- mount - BOOL, примонтировать = true; размонтировать = false</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - что-то пошло не так</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> os.</span><span style="color:#005CC5;">mountSD</span><span style="color:#24292E;">(mount)</span></span>
<span class="line"><span style="color:#6A737D;">-- mount - BOOL, примонтировать = true; размонтировать = false</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - что-то пошло не так</span></span></code></pre></div><h3 id="os-fileexists" tabindex="-1">os.fileExists() <a class="header-anchor" href="#os-fileexists" aria-label="Permalink to &quot;os.fileExists()&quot;">​</a></h3><p>Проверяет наличие файла, возвращает true/false</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">result </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> os.</span><span style="color:#79B8FF;">fileExists</span><span style="color:#E1E4E8;">(fileName)</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя проверяемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - файл не найден</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> os.</span><span style="color:#005CC5;">fileExists</span><span style="color:#24292E;">(fileName)</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя проверяемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - файл не найден</span></span></code></pre></div><h3 id="os-filesize" tabindex="-1">os.fileSize() <a class="header-anchor" href="#os-filesize" aria-label="Permalink to &quot;os.fileSize()&quot;">​</a></h3><p>Возвращает размер файла</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">result </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> os.</span><span style="color:#79B8FF;">fileSize</span><span style="color:#E1E4E8;">(fileName)</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя проверяемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - INT, размер файла в байтах или NIL, если файл не найден</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> os.</span><span style="color:#005CC5;">fileSize</span><span style="color:#24292E;">(fileName)</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя проверяемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - INT, размер файла в байтах или NIL, если файл не найден</span></span></code></pre></div><h3 id="os-fileremove" tabindex="-1">os.fileRemove() <a class="header-anchor" href="#os-fileremove" aria-label="Permalink to &quot;os.fileRemove()&quot;">​</a></h3><p>Удаляет файл</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">result </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> os.</span><span style="color:#79B8FF;">fileRemove</span><span style="color:#E1E4E8;">(fileName)</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя удаляемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - ошибка (например, нет файла)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> os.</span><span style="color:#005CC5;">fileRemove</span><span style="color:#24292E;">(fileName)</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя удаляемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - ошибка (например, нет файла)</span></span></code></pre></div><h3 id="os-filerename" tabindex="-1">os.fileRename() <a class="header-anchor" href="#os-filerename" aria-label="Permalink to &quot;os.fileRename()&quot;">​</a></h3><p>Переименовывает файл</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">result </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> os.</span><span style="color:#79B8FF;">fileRename</span><span style="color:#E1E4E8;">(old, new)</span></span>
<span class="line"><span style="color:#6A737D;">-- old - STR, старое имя переимновываемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- new - STR, новое имя переимновываемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - ошибка (например, нет файла)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> os.</span><span style="color:#005CC5;">fileRename</span><span style="color:#24292E;">(old, new)</span></span>
<span class="line"><span style="color:#6A737D;">-- old - STR, старое имя переимновываемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- new - STR, новое имя переимновываемого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - ошибка (например, нет файла)</span></span></code></pre></div><h3 id="os-fileread" tabindex="-1">os.fileRead() <a class="header-anchor" href="#os-fileread" aria-label="Permalink to &quot;os.fileRead()&quot;">​</a></h3><p>Читает файл</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">result </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> os.</span><span style="color:#79B8FF;">fileRead</span><span style="color:#E1E4E8;">(fileName)</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя целевого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - содержимое файла или NIL, если файл пустой или не найден</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> os.</span><span style="color:#005CC5;">fileRead</span><span style="color:#24292E;">(fileName)</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя целевого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- result - содержимое файла или NIL, если файл пустой или не найден</span></span></code></pre></div><h3 id="os-filewrite" tabindex="-1">os.fileWrite() <a class="header-anchor" href="#os-filewrite" aria-label="Permalink to &quot;os.fileWrite()&quot;">​</a></h3><p>Записывает данные в файл:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">result </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> os.</span><span style="color:#79B8FF;">fileWrite</span><span style="color:#E1E4E8;">(fileName,data[, overwrite])</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя целевого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- data - STR, данные</span></span>
<span class="line"><span style="color:#6A737D;">-- overwrite - BOOL, перезаписать файл (true)</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - ошибка (например, нет файла)</span></span>
<span class="line"><span style="color:#6A737D;">-- Пример:</span></span>
<span class="line"><span style="color:#E1E4E8;">os.</span><span style="color:#79B8FF;">fileWrite</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;/int/!file.db&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;привет</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#6A737D;">-- Для карты памяти необходимо использовать путь &quot;/sd/file.txt&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> os.</span><span style="color:#005CC5;">fileWrite</span><span style="color:#24292E;">(fileName,data[, overwrite])</span></span>
<span class="line"><span style="color:#6A737D;">-- fileName - STR, имя целевого файла</span></span>
<span class="line"><span style="color:#6A737D;">-- data - STR, данные</span></span>
<span class="line"><span style="color:#6A737D;">-- overwrite - BOOL, перезаписать файл (true)</span></span>
<span class="line"><span style="color:#6A737D;">-- result - BOOL, true - успех, false - ошибка (например, нет файла)</span></span>
<span class="line"><span style="color:#6A737D;">-- Пример:</span></span>
<span class="line"><span style="color:#24292E;">os.</span><span style="color:#005CC5;">fileWrite</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;/int/!file.db&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;привет</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6A737D;">-- Для карты памяти необходимо использовать путь &quot;/sd/file.txt&quot;</span></span></code></pre></div>`,82),e=[o];function t(c,r,i,y,E,u){return a(),l("div",null,e)}const g=s(p,[["render",t]]);export{h as __pageData,g as default};
