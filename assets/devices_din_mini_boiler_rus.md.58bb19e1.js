import{_ as s,o as a,c as e,Q as p}from"./chunks/framework.f1c0562b.js";const g=JSON.parse('{"title":"Модуль управления котлом отопления","description":"","frontmatter":{},"headers":[],"relativePath":"devices/din_mini_boiler_rus.md","filePath":"devices/din_mini_boiler_rus.md"}'),l={name:"devices/din_mini_boiler_rus.md"},o=p(`<h1 id="модуль-управления-котлом-отопления" tabindex="-1">Модуль управления котлом отопления <a class="header-anchor" href="#модуль-управления-котлом-отопления" aria-label="Permalink to &quot;Модуль управления котлом отопления&quot;">​</a></h1><p>Модуль управления отопительными котлами предствляет собой плату расширения для <a href="/devices/din_mini_base_rus">SLS DIN MINI</a>, с помошью которой можно подключить:</p><ul><li>Аппаратный мастер шины 1-Wire (датчики ds18b2 шиной)</li><li>Реле 1A для управления по методу - запрос тепла</li><li>Цифровая шина OpenTherm (Master) для подключения котла</li><li>Цифровая шина OpenTherm (Slave) для подключения комнатного термостата</li></ul><p>Список протестированных <a href="/ot_boiler_compatibility">отопительных котлов</a>.</p><h2 id="клеммы" tabindex="-1">Клеммы <a class="header-anchor" href="#клеммы" aria-label="Permalink to &quot;Клеммы&quot;">​</a></h2><ol><li>Шина 1-Wire</li><li>Питание +5V для шины 1-Wire</li><li>Цифровая шина OpenTherm Master / Реле (подключение котла, полярность не важна)</li><li>--/</li><li>Цифровая шина OpenTherm Slave (подключение комнатного термостата, полярность не важна)</li><li>--/</li></ol><h2 id="шина-1-wire" tabindex="-1">Шина 1-Wire <a class="header-anchor" href="#шина-1-wire" aria-label="Permalink to &quot;Шина 1-Wire&quot;">​</a></h2><p>Устройство содержит в себе аппаратный контроллер шины с активной подтяжкой.</p><p>В большинстве случаев не требуется подключения дополнительных резисторов подтяжки. Поддерживается паразитное питание и подключение нескольких датчиков шлейфом.</p><p>Шлюз поддерживает в данный момент до 10 датчиков Dallas DS18B20.</p><p>Управлять устройствами 1-Wire можно на странице /1wire.</p><h2 id="защита-цифровои-шины-от-высокого-напряжения" tabindex="-1">Защита цифровой шины от высокого напряжения <a class="header-anchor" href="#защита-цифровои-шины-от-высокого-напряжения" aria-label="Permalink to &quot;Защита цифровой шины от высокого напряжения&quot;">​</a></h2><p>Если необходимо использовать релейное управление и на клеммах котла напряжение выше 24V, необходимо снять перемычки на плате для защиты цифровой шины в устройстве, таким образом цифровая шина будет отключена от клемм 3 и 4.</p><h2 id="релеиное-управление-по-методу-запрос-тепла" tabindex="-1">Релейное управление по методу - запрос тепла <a class="header-anchor" href="#релеиное-управление-по-методу-запрос-тепла" aria-label="Permalink to &quot;Релейное управление по методу - запрос тепла&quot;">​</a></h2><p>Практически все котлы умеют управляться по методу - запрос тепла, Котел начинает греть ТН до температуры установленной на его встроенном термостате, когда замыкаются его клеммы термостата.</p><p>Реле в плате шилда подключено по NC схеме и при обесточивании системы будет подан сигнал к нагреву.</p><h2 id="управление-по-цифровои-шине-opentherm" tabindex="-1">Управление по цифровой шине OpenTherm <a class="header-anchor" href="#управление-по-цифровои-шине-opentherm" aria-label="Permalink to &quot;Управление по цифровой шине OpenTherm&quot;">​</a></h2><p>Шлюз может управлять отопительным котлом в нескольких режимах:</p><ol><li>В режиме термостата, тогда контроллер самостоятельно или по команде из вне управляет котлом отопления</li><li>В режиме прозрачного шлюза, когда котлом управляет комнатный термостат, а шлюз прозрачно транслирует его сообщения котлу и обратно, фиксируя текущее состояние системы. (<strong><em>В данный момент мониторинг доступен только через OpenTherm Monitor</em></strong>)</li></ol><p>К клеммам 5 и 6 возможно опциональное подключение комнатного термостата OpenTherm, таким образом устройство встает в разрыв шины OpenTherm.</p><p>Инициализация режима производится в стартовом скрипте init.lua</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">beginOpenTherm</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">)  </span><span style="color:#6A737D;">--прозрачный режим (наблюдение)</span></span>
<span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">beginOpenTherm</span><span style="color:#E1E4E8;">()      </span><span style="color:#6A737D;">--мастер (SLS выступает в роли термостата)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">beginOpenTherm</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">)  </span><span style="color:#6A737D;">--прозрачный режим (наблюдение)</span></span>
<span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">beginOpenTherm</span><span style="color:#24292E;">()      </span><span style="color:#6A737D;">--мастер (SLS выступает в роли термостата)</span></span></code></pre></div><h2 id="поддержка-opentherm-monitor" tabindex="-1">Поддержка OpenTherm Monitor <a class="header-anchor" href="#поддержка-opentherm-monitor" aria-label="Permalink to &quot;Поддержка OpenTherm Monitor&quot;">​</a></h2><p><a href="https://otgw.tclcode.com/otmonitor.html" target="_blank" rel="noreferrer">Opentherm Monitor</a> - это небольшая утилита, которая предназначена для того, чтобы помочь вам настроить и контролировать ваш шлюз OpenTherm.</p><p><img src="https://otgw.tclcode.com/otmonitor1.png" alt="icon"></p><p>Включение сервера:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">beginOpenThermMonitor</span><span style="color:#E1E4E8;">()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">beginOpenThermMonitor</span><span style="color:#24292E;">()</span></span></code></pre></div><p>Порт для подключения: 25238</p><h2 id="строгии-режим" tabindex="-1">Строгий режим <a class="header-anchor" href="#строгии-режим" aria-label="Permalink to &quot;Строгий режим&quot;">​</a></h2><p>Для уменьшения количества ошибок при чтении данных, можно включить строгий режим, тогда шлюз в случае изменения в полученных данных запрашивает их повторно и использует только если оба раза прочитаны одинаковые данные.</p><p>Включается командой: <em>thermo.setStrict(true)</em></p><h2 id="мониторинг-стутуса-работы" tabindex="-1">Мониторинг стутуса работы <a class="header-anchor" href="#мониторинг-стутуса-работы" aria-label="Permalink to &quot;Мониторинг стутуса работы&quot;">​</a></h2><p>Шлюз публикует текущее состояние работы в Объектах, можно привязать скрипт по изменению или же читать значения из своих скриптов.</p><h3 id="примеры-использования-в-скриптах" tabindex="-1">Примеры использования в скриптах <a class="header-anchor" href="#примеры-использования-в-скриптах" aria-label="Permalink to &quot;Примеры использования в скриптах&quot;">​</a></h3><p>Задать каналу реле режим выхода и выключить его:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">gpio.</span><span style="color:#79B8FF;">mode</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">25</span><span style="color:#E1E4E8;">, gpio.</span><span style="color:#B392F0;">OUTPUT</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">gpio.</span><span style="color:#79B8FF;">write</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">25</span><span style="color:#E1E4E8;">, gpio.</span><span style="color:#B392F0;">LOW</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">gpio.</span><span style="color:#005CC5;">mode</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">25</span><span style="color:#24292E;">, gpio.</span><span style="color:#6F42C1;">OUTPUT</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">gpio.</span><span style="color:#005CC5;">write</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">25</span><span style="color:#24292E;">, gpio.</span><span style="color:#6F42C1;">LOW</span><span style="color:#24292E;">)</span></span></code></pre></div><p>Запуск шлюза OpenTherm:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">beginOpenTherm</span><span style="color:#E1E4E8;">()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">beginOpenTherm</span><span style="color:#24292E;">()</span></span></code></pre></div><p>Установка температуры теплоносителя 50 градусов:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">setBoilerTemperature</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">setBoilerTemperature</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">50</span><span style="color:#24292E;">);</span></span></code></pre></div><p>Установка температуры горячей воды 50 градусов:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">setDHWTemperature</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">setDHWTemperature</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">50</span><span style="color:#24292E;">);</span></span></code></pre></div><p>Управлять уставкой можно несколькими способами, подоробнее об уставке можно прочитать в <a href="/heating_сurve">отдельном разделе</a>.</p><p>Включение отопления:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">setBoilerEnable</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">setBoilerEnable</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">)</span></span></code></pre></div><p>Включение нагрева горячей воды:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">setDHWEnable</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">setDHWEnable</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">)</span></span></code></pre></div><p>Включение строгого режима позволяет усреднить получаемые по OT значения, в SLS попадают только те значения, которые при следующем опросе были получены повторно.</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">setStrict</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">setStrict</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">true</span><span style="color:#24292E;">)</span></span></code></pre></div><p>Задать максимальное значение модуляции:</p><div class="language-lua vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">thermo.</span><span style="color:#79B8FF;">setMaxModulation</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">60</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">thermo.</span><span style="color:#005CC5;">setMaxModulation</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">60</span><span style="color:#24292E;">)</span></span></code></pre></div><p>Можно прочитать и отправить произвольные RAW значения</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">thermo.rawRead(14)           --запросить и прочитать значение 14 регистра</span></span>
<span class="line"><span style="color:#e1e4e8;">thermo.rawWrite(14,60*256)   --зададим максимальную модуляцию 60%</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">thermo.rawRead(14)           --запросить и прочитать значение 14 регистра</span></span>
<span class="line"><span style="color:#24292e;">thermo.rawWrite(14,60*256)   --зададим максимальную модуляцию 60%</span></span></code></pre></div><h2 id="mqtt-управление-opentherm" tabindex="-1">MQTT управление OpenTherm <a class="header-anchor" href="#mqtt-управление-opentherm" aria-label="Permalink to &quot;MQTT управление OpenTherm&quot;">​</a></h2><p>Шлюз публикует состояние в топик <em>xxx/thermo/</em>, где xxx - префикс MQTT</p><p>Установка температуры теплоносителя:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">xxx/thermo/boiler/set/target_temperature</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">xxx/thermo/boiler/set/target_temperature</span></span></code></pre></div><p>Установка температуры горячей воды:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">xxx/thermo/dhw/set/target_temperature</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">xxx/thermo/dhw/set/target_temperature</span></span></code></pre></div><p>Включение/выключение отопления:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">xxx/thermo/boiler/set/enable true/false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">xxx/thermo/boiler/set/enable true/false</span></span></code></pre></div><p>Включение/выключение нагрева горячей воды:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">xxx/thermo/dhw/set/enable true/false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">xxx/thermo/dhw/set/enable true/false</span></span></code></pre></div><p>Срос ошибки котла:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">xxx/thermo/ot/set/error_code      0</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">xxx/thermo/ot/set/error_code      0</span></span></code></pre></div><p>Установка максимального уровня модуляции:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">xxx/thermo/ot/set/max_modulation</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">xxx/thermo/ot/set/max_modulation</span></span></code></pre></div><h2 id="статьи" tabindex="-1">Статьи <a class="header-anchor" href="#статьи" aria-label="Permalink to &quot;Статьи&quot;">​</a></h2><p><a href="/ui_graph">Построение графиков работы котла</a></p><p><a href="/heating_сurve">Управление по кривым отопления</a></p><p><a href="https://homever.ru/?p=1417" target="_blank" rel="noreferrer">Фантастический OpenTherm и где он обитает</a></p><p><a href="https://igorkandaurov.com/2022/10/12/sls-%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B3%D0%B0%D0%B7%D0%BE%D0%B2%D1%8B%D0%BC-%D0%BA%D0%BE%D1%82%D0%BB%D0%BE%D0%BC/" target="_blank" rel="noreferrer">SLS: управление газовым котлом</a></p>`,72),n=[o];function t(r,c,i,d,h,u){return a(),e("div",null,n)}const E=s(l,[["render",t]]);export{g as __pageData,E as default};
